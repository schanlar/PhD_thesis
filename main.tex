% INITIAL CONFIGURATION
\documentclass[a4paper, 10pt, twoside]{book}

%%% FOR INLINE ENUMERATION %%%%
\newcounter{inlineenum}
\renewcommand{\theinlineenum}{\alph{inlineenum}}
\newcommand{\inlineitem}[1][]{\refstepcounter{inlineenum}{(\theinlineenum)~#1}}
\newcommand{\resetinlineenum}{\setcounter{inlineenum}{0}}
%%% %%%%


\usepackage{titlesec} % Format title, chapter, sections etc
                      % check out: https://ctan.org/pkg/titlesec?lang=en
\usepackage{minitoc}
\usepackage{lscape}
\usepackage{afterpage}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{epigraph}
\usepackage{lipsum}
\usepackage[detect-none]{siunitx}
\sisetup{range-phrase = \text{--}}
\sisetup{group-separator = {,}}
\usepackage{xspace}
\usepackage[utf8]{inputenc}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{txfonts}
\usepackage{multirow}
\usepackage{xcolor}
\usepackage{longtable}
\usepackage{appendix}
\usepackage{chngcntr}

\usepackage{nomencl}
\makenomenclature

% Define a command for easier nomenclature entries (optional)
\newcommand{\nomencl}[2]{\nomenclature{#1}{#2}}


% Set the depth and numbering
% for table of contents (toc)
\setcounter{tocdepth}{2}
\setcounter{secnumdepth}{2}


% Define function for making first letter bigger
\font\Cal=cmsy10 at 40pt
\textwidth=.5\textwidth
\def\pstart#1{\noindent\smash{\lower3ex\hbox{\llap{\Cal#1}}\hskip-.2em}
  \parshape=3 2.0em \dimexpr\hsize-1.5em 2em \dimexpr\hsize-2em 0pt \hsize}
  % \parshape x (=number of lines) y (=amount of indent) i (=textwidth) [yi, yi,...]
  
% Epigraph settings
\renewcommand{\textflush}{flushright}
\setlength{\epigraphrule}{0pt}
%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% START OF FORMATING %%%
%%% FORMAT THE STYLE OF CHAPTERS, SECTIONS ETC %%%
% Add a horizontal line in the header
\newpagestyle{main}{%
  \sethead[\thepage][][\chaptertitle]{\thesection\ \sectiontitle}{}{\thepage}
  \headrule
}
\pagestyle{main}

% Display format of the chapter
\titleformat{\chapter}[display]
{\large}
{\filleft\MakeUppercase{\chaptertitlename} \Huge\thechapter}
{2ex}
{\LARGE\bfseries\filleft}
[\vspace{2ex}%
\titlerule]

% Display format of the section
% \titleformat{\section}[block]
% {\filcenter\large
% \addtolength{\titlewidth}{2pc}%
% \titleline*[c]{\titlerule*[.6pc]{\tiny\textbullet}}%
% \addvspace{6pt}%
% \normalfont\bfseries\sffamily}
% {\thesection}{1em}{}
% \titlespacing{\section}
% {5pc}{*2}{*2}[5pc]

% Display format of the subsection
\titleformat{\subsection}[block]
{\normalfont\sffamily}
{\thesubsection}{.5em}{\titlerule\\[.8ex]\bfseries}

% Display format of the subsubsection
\titleformat{\subsubsection}[wrap]
{\normalfont\fontseries{b}\selectfont\filright}
{\thesubsubsection.}{.5em}{}
\titlespacing{\subsubsection}
{12pc}{1.5ex plus .1ex minus .2ex}{1pc}

%%% END OF FORMATING %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[              % Left and right margins
    DIV=18,               % You can play with these numbers for a better
    BCOR=1mm,             % reference look into KOMA-Script CTAN manual
    headinclude=true,
    footinclude=false,
    paper=A4
    ]{typearea}
    
% BASIC THESIS INFORMATION
\def\title{UNDERSTANDING THE MASS SPECTRUM OF NEUTRON STARS}
\def\thesisauthor{Savvas Chanlaridis}


% commands below work only for twoside option of \documentclass
\makeatletter
\if@twoside
    \newlength{\textblockoffset}
    \setlength{\textblockoffset}{10mm}
    \addtolength{\hoffset}{\textblockoffset}
    \addtolength{\evensidemargin}{-2.0\textblockoffset}
\fi
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PACKAGES
\usepackage{amsmath,amssymb,mathrsfs}  % Basic math packages
\usepackage{subfiles}
\usepackage{natbib}                    % A&A bibliography style
\bibpunct{(}{)}{;}{a}{}{,}
\usepackage{fancyhdr, graphicx}
\usepackage{upgreek}                   % More greek letters
\usepackage{enumerate}
\usepackage{commath}

% to know the page width and adjust the image size!
\usepackage{printlen} % \uselengthunit{in}\printlength{\textwidth}

% TABLE PACKAGES
\usepackage{etoolbox}
\BeforeBeginEnvironment{tabular}{\small}
\usepackage{booktabs}
\usepackage{multirow}

% IMAGES PACAKGES
\usepackage{graphicx}
\usepackage[font=small]{caption}
\newtheorem{theorem}{Theorem}
\usepackage{subcaption}

% TIKZ & PGFPLOTS
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{pgfplots}
%\pgfplotsset{compat=1.14}
\usetikzlibrary{
    calc,
    patterns,
    circuits.logic.US,
    circuits.ee.IEC,
    intersections,
    angles,
    quotes,
    arrows,
    shapes,
    }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% DEDICATION PAGE CONFIGURATION
\newenvironment{dedication}
  {
   \clearpage            % Start on a new page
   \thispagestyle{empty} % Page without headers or footers
   \vspace*{\stretch{1}} % Add vertical space to push the text down
   \itshape              % Italicize the text
   \centering            % Center the text horizontally
  }
  {
   \par                  % Ensure the paragraph ends here
   \vspace{\stretch{3}}  % Add additional vertical space at the bottom
   \clearpage            % End on a new page, ready for the next section
  }

   
% WRITE GREEK TEXT
\usepackage[greek,english]{babel}
%\selectlanguage{greek}
\languageattribute{greek}{polutoniko}

\newenvironment{mygreek}
  {\clearpage
   \thispagestyle{empty}
   \vspace*{\stretch{1}}
   \itshape
   \raggedleft}
  {\par
   \vspace{\stretch{3}}
   \clearpage}

% Inline enumerated lists
\usepackage[inline]{enumitem}
\usepackage{pdfpages}
%\includepdfset{offset=0.7cm -0cm}
%\usepackage[fulladjust]{marginnote}

% PDF CONFIGURATION
\definecolor{xlinkcolor}{cmyk}{1,1,0,0}
% \definecolor{xlinkcolor}{cmyk}{0,0,0,100} % black color -- for printed version
\usepackage{hyperref}
\hypersetup{
    breaklinks,
    pdffitwindow=true,
    pdfstartview={FitH},
    pdftitle={PhD Thesis},                     % TITLE
    pdfauthor={Savvas Chanlaridis},            % AUTHOR
    pdfsubject={\title},                       % DOCUMENT SUBJECT
    pdfcreator={Savvas Chanlaridis},           % CREATOR
    pdfproducer={\thesisauthor},               % PRODUCER
    pdfkeywords={Astronomy, Astrophysics},
    pdfnewwindow=true,
    pdfborder={0 0 0},
    colorlinks=true,                           % COMMENT FOR BLACK LINKS
    linkcolor=xlinkcolor,
    citecolor=xlinkcolor,
    urlcolor=blue
    }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{definitions.tex}
\newcommand{\seriesone}{\textsc{Series\,I}\xspace}  % Series I
\newcommand{\seriestwo}{\textsc{Series\,II}\xspace} % Series II


%% Control how chapter appendices appear
\AtBeginEnvironment{subappendices}{%
  \clearpage
  \section*{Appendix}
  \addcontentsline{toc}{section}{Appendix}
  \counterwithin{figure}{section}
  \counterwithin{table}{section}
}


%%% END OF PREAMBLE %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
    \frontmatter  % front and main matter to make roman numbers in between.

    %%% FIRST PAGE TITLE %%%
    \subfile{titlepage/titlepage}
    \newpage  
    \mbox{}
    \thispagestyle{empty}

    %%% SIGNATURE/STATEMENT PAGE %%%
    \subfile{signaturepage/signaturepage}
    \newpage  
    \mbox{}
    \thispagestyle{empty}

    %%% ABSTRACT PAGE %%%
    \subfile{abstract/abstract}
    \addcontentsline{toc}{chapter}{Abstract}
    \adjustmtc
    \newpage  
    \mbox{}
    \thispagestyle{empty}

    %%% DEDICATION PAGE %%%
    \subfile{dedication/dedication}
    \newpage  
    \mbox{}
    \thispagestyle{empty}

    %%% ACKNOWLEDGMENTS PAGE %%%
    \subfile{acknowledgements/acknowledgements}
    \addcontentsline{toc}{chapter}{Acknowledgements}
    \adjustmtc
    \newpage
    \mbox{}
    \thispagestyle{empty}

    %%% TABLE OF CONTENT %%%
    {  
    \cleardoublepage
    \phantomsection
    % CHANGE COLOR LINK FOR TOC ONLY
    \hypersetup{linkcolor=black, pdfborder={0 0 0}} % Use pdfborder={0 0 1} for a red border to appear around a link
    \dominitoc
    \tableofcontents
    \adjustmtc % necessary for displaying the minitoc after using \addcontentsline
    }

    %%% LIST OF FIGURES %%%
    \cleardoublepage
    \phantomsection
    \addcontentsline{toc}{chapter}{List of Figures}
    {
    \hypersetup{linkcolor=black, pdfborder={0 0 0}, citecolor=black}
    \listoffigures 
    \adjustmtc
    }
    
    %%% LIST OF TABLES %%%
    \cleardoublepage
    \phantomsection
    \addcontentsline{toc}{chapter}{List of Tables}
    {
    \hypersetup{linkcolor=black, pdfborder={0 0 0}, citecolor=black}
    \listoftables
    \adjustmtc 
    \newpage  
    \mbox{}
    \thispagestyle{empty}
    }
    
    %%% NOMENCLATURE %%%
    \subfile{nomenclature/nomenclature}
    \addcontentsline{toc}{chapter}{Glossary and Nomenclature}
    \adjustmtc
    \newpage 
    \mbox{}
    \thispagestyle{empty}


    \mainmatter  % front and main matter to make roman numbers in between

    % BODY
    \subfile{chapters/chapter1/chapter1}
    \subfile{chapters/chapter2/chapter2}
    \subfile{chapters/chapter3/chapter3}
    % \subfile{chapters/chapter4/chapter4}
    % \subfile{chapters/chapter5/chapter5}


    % APPENDICES
    \appendix
    \addcontentsline{toc}{chapter}{Appendices}
    \adjustmtc
    \subfile{appendices/appendix1/appendix1}
    \subfile{appendices/appendix2/appendix2}
    % \subfile{appendices/appendix3/appendix3}
    

    % REFERENCES
    % If you are using a windows machine and the bibliography doesn't work
    % remove the extension for .bst and .bib files here!

    \bibliographystyle{bibliography/bibstyle_apj.bst}
    \bibliography{bibliography/bibfile_thesis}
    \addcontentsline{toc}{chapter}{Bibliography}
    \adjustmtc


\end{document}